<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://nasirlukman.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://nasirlukman.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-11-15T09:23:57+00:00</updated><id>https://nasirlukman.github.io/feed.xml</id><title type="html">Earth.etc</title><subtitle></subtitle><entry><title type="html">Different Distance Metrics Example in Spectral Unmixing</title><link href="https://nasirlukman.github.io/blog/2015/mathsa/" rel="alternate" type="text/html" title="Different Distance Metrics Example in Spectral Unmixing"/><published>2015-10-20T15:12:00+00:00</published><updated>2015-10-20T15:12:00+00:00</updated><id>https://nasirlukman.github.io/blog/2015/mathsa</id><content type="html" xml:base="https://nasirlukman.github.io/blog/2015/mathsa/"><![CDATA[<p>In data space, distance typically measures similarity between data points. For instance, if points <em>a</em> and <em>b</em> are “close” to each other (i.e., have a small distance), they are considered more similar. When distance equals zero, data points <em>a</em> and <em>b</em> are exactly the same. This concept is essential in machine learning and data analysis as it quantifies similarity between datasets.</p> <p>In two dimensions, it’s easy to visualize data points and assess their distances, such as in this example:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5C1-480.webp 480w,/assets%5Cimg%5C1-800.webp 800w,/assets%5Cimg%5C1-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5C1.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 1. Three points in two dimensional space </div> <p>Visually, most of us would agree that points <em>a</em> and <em>b</em> appear closer to each other compared to <em>a</em> and <em>c</em>. But is this really the case? To confirm, we need to define what we mean by “distance” and calculate the distance between each point.</p> <p>In this post, we will examine three different distance metrics and compare their performance in a hypothetical spectral unmixing problem: Euclidean distance, Manhattan distance, and angular distance. The illustration of these three distance measurements is shown below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5Cpost_1_image_2_three_type_of_distance-480.webp 480w,/assets%5Cimg%5Cpost_1_image_2_three_type_of_distance-800.webp 800w,/assets%5Cimg%5Cpost_1_image_2_three_type_of_distance-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5Cpost_1_image_2_three_type_of_distance.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 2. How the three different distance metrics measure distance between two point in two dimensional space </div> <h3 id="euclidean-distance">Euclidean Distance</h3> <p>The most common and intuitive distance is Euclidean distance, also often referred to as \(L_2\) distance. Between two points <em>a</em> and <em>b</em> in data space, Euclidean distance is simply the straight-line distance between the points, which can be expressed mathematically as:</p> \[L_2 = \sqrt{\sum_{i=1}^n (a_i - b_i)^2}\] <h3 id="manhattan-distance">Manhattan Distance</h3> <p>Another way to measure distance from a to b is to follow a path parallel to the axes. For example, in the image below, we first move parallel to the y-axis for 1 units, followed by a parallel path along the x-axis for 1 units, and then sum the total path length. This type of “gridded” path is called Manhattan distance (after the gridded road pattern of Manhattan) or \(L_1\) distance. Mathematically, it can be expressed as:</p> \[L_1 = \sum_{i=1}^n |a_i - b_i|\] <h3 id="angular-distance">Angular Distance</h3> <p>For angular distance \((\theta)\), we treat points <em>a</em> and <em>b</em> as two vectors originating from the origin \((0,0)\). The angular distance is simply the angle between the two vectors, expressed as:</p> \[\theta = \arccos \left( \frac{a \cdot b}{\|a\| \|b\|} \right)\] <p>In machine learning, angular distance is more commonly referred to as cosine similarity (measured as the cosine of the angle). In spectral analysis, this is often called Spectral Angle Mapping (SAM) and is widely used for spectral matching. Mathematically, angular distance is only valid as a metric if we normalize our data to unit vectors. For unit vectors, this measurement gives the same result as Euclidean distance after normalizing the data.</p> <h3 id="practical-example-linear-spectral-unmixing">Practical Example: Linear Spectral Unmixing</h3> <p>To illustrate cases in which each distance metric is more appropriate, let’s use linear spectral unmixing as an example. Assuming a linear mixture model, a mixed spectrum of several different objects (or “endmembers”) is defined as:</p> \[y = E a + n\] <p>where:</p> <ul> <li>\(y\) is the observed spectrum,</li> <li>\(E\) is the endmember matrix,</li> <li>\(a\) is the abundance vector,</li> <li>\(n\) represents noise.</li> </ul> <p>In this equation, \(y\) is known from observation, and for simplicity, we assume that a matrix of possible endmembers \(E\) is also known, and noise \(n\) is negligible. The goal is to solve for \(a\) by minimizing the difference between the modeled spectrum \(E a\) and the observed spectrum \(y\), under the conditions that all values of \(a\) are non-negative and sum to one. This may achieved by solving this optimization problem:</p> \[\min_{\mathbf{a}} \; D(\mathbf{y} - \mathbf{E} \mathbf{a})\] <p>subject to:</p> \[a_i \geq 0 \quad \text{and} \quad \sum_{i=1}^{n} a_i = 1\] <p>This is where distance metrics come in which in the equation above written as \(D()\). The difference we are trying to minimize can be calculated using different distance metrics, also known as loss functions in optimization contexts. Different distance metrics can lead to different results. Now, let’s run some tests under various scenarios to see how each distance metric performs.</p> <hr/> <p>For the first test, suppose we have four mineral endmembers (example taken from USGS Spectral Library), as shown below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5Cpost_1_image_3_four_endmembers-480.webp 480w,/assets%5Cimg%5Cpost_1_image_3_four_endmembers-800.webp 800w,/assets%5Cimg%5Cpost_1_image_3_four_endmembers-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5Cpost_1_image_3_four_endmembers.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 3. Endmember spectra for Calcite, Kaolinite, Muscovite, and Quartz </div> <p>We’ll generate 1000 synthetic mixtures with the following conditions:</p> <ol> <li>The mixtures follow the linear mixture model equation.</li> <li>Noise is normally distributed with a mean of 0 and a standard deviation chosen randomly between 1e-5 and 1e-3.</li> </ol> <p>The accuracy of the spectral unmixing using the three distance metrics are shown below:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5Cpost_1_first_test-480.webp 480w,/assets%5Cimg%5Cpost_1_first_test-800.webp 800w,/assets%5Cimg%5Cpost_1_first_test-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5Cpost_1_first_test.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 4. Hisotgram showing the accuracy (RMSE) of 1000 sepctral unmixing using three different distance metrics </div> <p>In this case, Euclidean distance clearly outperforms the other two metrics, as it is well-suited for data with normally distributed noise. Under these conditions, minimizing Euclidean distance is equivalent to maximum likelihood estimation.</p> <p>For the second test, we use the same synthetic mixtures, but this time we add random “spikes,” where each wavelength band has a 1% chance of being randomly increased or decreased by a value between 0.05 and 0.2. While this type of noise is not common in remote sensing or spectroscopy, it will help us illustrate the strengths of Manhattan distance. The accuracy of the spectral unmixing of these synthetic mixtures are shown below:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5Cpost_1_second_test-480.webp 480w,/assets%5Cimg%5Cpost_1_second_test-800.webp 800w,/assets%5Cimg%5Cpost_1_second_test-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5Cpost_1_second_test.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 4. Hisotgram showing the accuracy (RMSE) of 1000 sepctral unmixing using three different distance metrics </div> <p>Here, Manhattan distance outperforms the other metrics. Manhattan distance is known to be more robust to extreme outliers than Euclidean distance, which squares the error term, making it sensitive to outliers. In contrast, Manhattan distance only takes the absolute value of location differences, making it less affected by outliers.</p> <p>While random spikes in reflectance values may not be common in spectroscopy or remote sensing, brightness differences and inaccurate endmember spectra are issues that often arise with real datasets. To illustrate this problem, let’s use two sets of endmember spectra from the USGS spectral library. We use the first set to generate synthetic mixtures and the second set to solve the unmixing problem. This experiment simulates the real-world scenario where exact endmember spectra are challenging to obtain, and the available spectra may differ in brightness from the actual spectra.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets%5Cimg%5Cpost_1_third_test-480.webp 480w,/assets%5Cimg%5Cpost_1_third_test-800.webp 800w,/assets%5Cimg%5Cpost_1_third_test-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets%5Cimg%5Cpost_1_third_test.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Image 5. Hisotgram showing the accuracy (RMSE) of 1000 sepctral unmixing using three different distance metrics </div> <p>In this case, angular distance (or SAM) has the lowest error, as it essentially ignores magnitude (brightness) differences and focuses on the shape of the spectra. To illustrate further, two spectra may be considered different by Manhattan and Euclidean distances, but angular distance would see them as identical if they have the same shape, regardless of magnitude. This feature is one reason why angular distance is widely used in remote sensing applications, where brightness differences are common.</p> <p>Returning to our initial visualization (Image 1): Is point <em>a</em> closer to point <em>b</em> than to point <em>c</em>? Again, the answer depends on the distance metric. Using Euclidean and Manhattan distances, this statement holds true. However, with angular distance, it is false, as points <em>a</em> and <em>c</em> have an angular distance of \(0\), while <em>a</em> and <em>b</em> have a non-zero angular distance.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="math"/><summary type="html"><![CDATA[an example of a blog post with some math]]></summary></entry></feed>