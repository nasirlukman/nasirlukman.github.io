<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Earthquake Playthrough 01 | Earth.etc </title> <meta name="author" content="Muhamad Nasir Lukman"> <meta name="description" content="Practicing python with earthquake data from USGS libcomcat API"> <meta name="keywords" content="remote sensing, gis, image analysis, machine learning, geology, earth science, earth observation, geophysics, planetary science, satelite"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nasirlukman.github.io/blog/2021/Earthquake-Playthrough-01/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Earth.etc </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/post/index.html">post </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Earthquake Playthrough 01</h1> <p class="post-meta"> August 01, 2021 </p> <p class="post-tags"> <a href="/blog/2021"> <i class="fa-solid fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> python</a>   <a href="/blog/tag/geology"> <i class="fa-solid fa-hashtag fa-sm"></i> geology</a>   <a href="/blog/tag/earthquake"> <i class="fa-solid fa-hashtag fa-sm"></i> earthquake</a>   <a href="/blog/tag/libcomcat"> <i class="fa-solid fa-hashtag fa-sm"></i> libcomcat</a>   <a href="/blog/tag/data"> <i class="fa-solid fa-hashtag fa-sm"></i> data</a>   <a href="/blog/tag/pandas"> <i class="fa-solid fa-hashtag fa-sm"></i> pandas</a>   <a href="/blog/tag/matplotlib"> <i class="fa-solid fa-hashtag fa-sm"></i> matplotlib</a>   <a href="/blog/tag/numpy"> <i class="fa-solid fa-hashtag fa-sm"></i> numpy</a>   <a href="/blog/tag/basemap"> <i class="fa-solid fa-hashtag fa-sm"></i> basemap</a>   <a href="/blog/tag/usgs"> <i class="fa-solid fa-hashtag fa-sm"></i> USGS</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>USGS provides a very useful API to their earthquake catalog called <code class="language-plaintext highlighter-rouge">libcomcat</code> which I think stands for <a href="https://github.com/usgs/libcomcat" rel="external nofollow noopener" target="_blank"><em>library comprehensive catalog</em></a>. In this post, we will try to use <code class="language-plaintext highlighter-rouge">libcomcat</code> to get the earthquake dataset and make some data visualization from it. Hopefully, we can exercise a few python libraries while also learning a few interesting facts about earthquakes.</p> <h1 id="using-libcomcat-to-get-our-dataframe">Using <code class="language-plaintext highlighter-rouge">libcomcat</code> to get our dataframe</h1> <p>According to its <a href="https://github.com/usgs/libcomcat/blob/master/docs/api.md" rel="external nofollow noopener" target="_blank">API Documentation</a> we can use the <code class="language-plaintext highlighter-rouge">search</code> module to get a <code class="language-plaintext highlighter-rouge">SummaryEvent</code> objects and use <code class="language-plaintext highlighter-rouge">get_summary_dataframe</code> to create a <code class="language-plaintext highlighter-rouge">pandas</code> Dataframe of basic information from a list of <code class="language-plaintext highlighter-rouge">SummaryEvent</code> object which contains the following columns:</p> <ul> <li>id: Authoritative ComCat event ID.</li> <li>time: Authoritative event origin time.</li> <li>latitude: Authoritative event latitude.</li> <li>longitude: Authoritative event longitude.</li> <li>depth: Authoritative event depth.</li> <li>magnitude: Authoritative event magnitude.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">libcomcat.search</span> <span class="kn">import</span> <span class="n">search</span>
<span class="kn">from</span> <span class="n">libcomcat.dataframes</span> <span class="kn">import</span> <span class="n">get_summary_data_frame</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1">#setting libcomcat search parameters
</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">104.414</span><span class="p">,</span> <span class="mf">127.266</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.017</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.119</span><span class="p">]</span>
<span class="n">stime</span> <span class="o">=</span> <span class="nf">datetime</span><span class="p">(</span><span class="mi">1940</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">etime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">utcnow</span><span class="p">()</span>
<span class="n">minmag</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">maxmag</span> <span class="o">=</span> <span class="mf">9.9</span>

<span class="c1">#download SummaryEvent objects based on our predifined search parameters
</span><span class="n">eventlist</span> <span class="o">=</span> <span class="nf">search</span><span class="p">(</span><span class="n">starttime</span><span class="o">=</span><span class="n">stime</span><span class="p">,</span>
                  <span class="n">endtime</span><span class="o">=</span><span class="n">etime</span><span class="p">,</span>
                  <span class="n">minlatitude</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                  <span class="n">maxlatitude</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                  <span class="n">minlongitude</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                  <span class="n">maxlongitude</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                  <span class="n">minmagnitude</span><span class="o">=</span><span class="n">minmag</span><span class="p">,</span>
                  <span class="n">maxmagnitude</span><span class="o">=</span><span class="n">maxmag</span><span class="p">)</span>

<span class="c1">#write summary dataframe into pandas Dataframe
</span><span class="n">df</span> <span class="o">=</span> <span class="nf">get_summary_data_frame</span><span class="p">(</span><span class="n">eventlist</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <p>Notes: Since we are trying to search SummaryEvent objects in a broad bounds area and wide time &amp; magnitude range, this may take a few minutes</p> </blockquote> <p>we can inspect the first five rows of our Dataframe using <code class="language-plaintext highlighter-rouge">data.head()</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>Unnamed: 0</th> <th>id</th> <th>time</th> <th>location</th> <th>latitude</th> <th>longitude</th> <th>depth</th> <th>magnitude</th> <th>alert</th> <th>url</th> <th>eventtype</th> <th>significance</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>0</td> <td>iscgemsup901250</td> <td>1940-03-21 13:52:54.000</td> <td>south of Java, Indonesia</td> <td>-10.316</td> <td>107.677</td> <td>15.0</td> <td>6.3</td> <td>NaN</td> <td>https://www.usgs.gov/programs/earthquake-hazards/earthquakes</td> <td>earthquake</td> <td>611</td> </tr> <tr> <th>1</th> <td>1</td> <td>iscgemsup899784</td> <td>1943-04-01 14:18:17.000</td> <td>38 km W of Labuan, Indonesia</td> <td>-6.389</td> <td>105.480</td> <td>35.0</td> <td>7.1</td> <td>NaN</td> <td>https://www.usgs.gov/programs/earthquake-hazards/earthquakes</td> <td>earthquake</td> <td>776</td> </tr> <tr> <th>2</th> <td>2</td> <td>iscgem899940</td> <td>1943-07-23 14:53:10.000</td> <td>87 km SW of Srandakan, Indonesia</td> <td>-8.591</td> <td>109.803</td> <td>60.0</td> <td>7.0</td> <td>NaN</td> <td>https://www.usgs.gov/programs/earthquake-hazards/earthquakes</td> <td>earthquake</td> <td>754</td> </tr> <tr> <th>3</th> <td>3</td> <td>iscgem896483</td> <td>1949-04-23 11:15:33.000</td> <td>95 km N of Ruteng, Indonesia</td> <td>-7.763</td> <td>120.611</td> <td>20.0</td> <td>6.4</td> <td>NaN</td> <td>https://www.usgs.gov/programs/earthquake-hazards/earthquakes</td> <td>earthquake</td> <td>630</td> </tr> <tr> <th>4</th> <td>4</td> <td>iscgem896607</td> <td>1949-06-24 22:38:49.000</td> <td>42 km W of Labuan, Indonesia</td> <td>-6.381</td> <td>105.449</td> <td>60.0</td> <td>6.3</td> <td>NaN</td> <td>https://www.usgs.gov/programs/earthquake-hazards/earthquakes</td> <td>earthquake</td> <td>611</td> </tr> </tbody> </table> <p>5 rows x 12 columns</p> </div> <p>We must be cautious with the units of each variable in our data, which in this case are as follows :</p> <ul> <li>x and y coordinates in decimal degrees</li> <li>depths in kilometers below sea level</li> <li>magnitude in Moment Magnitude (Mw)</li> </ul> <blockquote> <p>We may be familiar with <em>the Ritcher Scale</em> as the unit of earthquake magnitude. Since there are a few proven inaccuracies in <em>the Ritcher Scale</em> most seismology authorities reported their magnitude in <em>Moment Magnitude</em>. These two units measure earthquake magnitude in base ten logarithmic scale and the difference between the units is quite low. Consult <a href="https://en.wikipedia.org/wiki/Seismic_magnitude_scales" rel="external nofollow noopener" target="_blank">wikipedia</a> for more information about this.</p> </blockquote> <h1 id="map-plot-with-basemap">Map plot with <code class="language-plaintext highlighter-rouge">Basemap</code> </h1> <p>We already define our boundary area above that we use as one of the search parameters. Let’s look at the map of our area using <code class="language-plaintext highlighter-rouge">Basemap</code>. Since our coordinates are in decimal degrees, we will use <em>EPSG:4326</em> as our projection parameters. We can look at IPSG code for other projections <a href="http://epsg.io/" rel="external nofollow noopener" target="_blank">here</a>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1">#define the figure
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">#creating a basemap
</span><span class="n">m</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">epsg</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4326</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">resolution</span> <span class="o">=</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">m</span><span class="p">.</span><span class="nf">shadedrelief</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_11_0.png" alt="png"></p> <p>We can plot our earthquake on a map using <code class="language-plaintext highlighter-rouge">Basemap</code> scatter with <em>longitude</em> and <em>latitude</em> as its <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> parameters. While we’re at it, let’s try to add <em>depth</em> and <em>magnitude</em> as its <code class="language-plaintext highlighter-rouge">color</code> and <code class="language-plaintext highlighter-rouge">size</code> parameters.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>

<span class="c1">#define the figure
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">#creating a basemap
</span><span class="n">m</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">epsg</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4326</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">resolution</span> <span class="o">=</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">m</span><span class="p">.</span><span class="nf">shadedrelief</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#plotting the earthquakes
</span><span class="n">cax</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">longitude</span><span class="sh">'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">latitude</span><span class="sh">'</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
          <span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">coolwarm</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_13_0-480.webp 480w,/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_13_0-800.webp 800w,/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_13_0-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_13_0.png" class="img-fluid rounded" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Image 2. Earthquake depth (km) </div> <p>It’s interesting how the depth of the earthquake is increasing to the north. It’s most probably related to the subducted oceanic crust depth which also must be increasing to the north. A section along the latitude would show the shape of the subducted oceanic crust, we will try to make it later.</p> <p>Another piece of information that we can get from the plot above is that the earthquakes are not distributed uniformly along the subduction zone. There are several areas with significantly fewer earthquake occurrences than it’s surroundings which are usually referred to as <a href="https://en.wikipedia.org/wiki/Seismic_gap#:~:text=A%20seismic%20gap%20is%20a,segments%20along%20the%20same%20structure." rel="external nofollow noopener" target="_blank"><em>seismic gap</em></a>. let’s try to make a density heatmap to get a better visualization for this. We will use <code class="language-plaintext highlighter-rouge">np.histogram</code> to calculate a gridded density of the earthquake and plot it with <code class="language-plaintext highlighter-rouge">plt.pcolormash()</code> above our <code class="language-plaintext highlighter-rouge">Basemap</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># define x,y,and z values
</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">longitude</span><span class="sh">'</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">latitude</span><span class="sh">'</span><span class="p">]</span>
<span class="n">z</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1">#define the figure
</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1">#creating a basemap
</span><span class="n">m</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">epsg</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4326</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">resolution</span> <span class="o">=</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">m</span><span class="p">.</span><span class="nf">shadedrelief</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#plot colormesh with alpha&lt;1 for transparency
</span><span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span><span class="p">,</span> <span class="n">z</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_15_0.png" alt="png"></p> <p>we can go one step further and use <em>kernel density estimation</em> to draw a smoother density heatmap by using <code class="language-plaintext highlighter-rouge">gaussian_kde</code> from <code class="language-plaintext highlighter-rouge">scipy</code>.</p> <blockquote> <p><em>kernel density estimation</em> or KDE for short is a statistical method to estimate the probability density function of a random variable based on a finite sample. <a href="https://mathisonian.github.io/kde/" rel="external nofollow noopener" target="_blank">Here</a> is a very neat explanation of how KDE works on one-dimensional data.</p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">scipy.stats.kde</span> <span class="kn">import</span> <span class="n">gaussian_kde</span>

<span class="c1">#define x,y, and z values
</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">longitude</span><span class="sh">'</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">latitude</span><span class="sh">'</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="nf">gaussian_kde</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
<span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="nf">min</span><span class="p">():</span><span class="n">x</span><span class="p">.</span><span class="nf">max</span><span class="p">():</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">1j</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="nf">min</span><span class="p">():</span><span class="n">y</span><span class="p">.</span><span class="nf">max</span><span class="p">():</span><span class="n">y</span><span class="p">.</span><span class="n">size</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">1j</span><span class="p">]</span>
<span class="n">zi</span> <span class="o">=</span> <span class="nf">k</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">([</span><span class="n">xi</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">yi</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()]))</span>

<span class="c1">#define the figure
</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1">#creating a basemap
</span><span class="n">m</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">epsg</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4326</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">resolution</span> <span class="o">=</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">llcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">llcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">urcrnrlon</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="n">urcrnrlat</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">m</span><span class="p">.</span><span class="nf">shadedrelief</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#plot colormesh with alpha&lt;1 for transparency
</span><span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">xi</span><span class="p">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_18_1.png" alt="png"></p> <p>We can see from the map above that the most notable <em>seismic gap</em> are located at the south of Central and West Java, Bali &amp; Lombok, and NTT.</p> <h1 id="cross-section">Cross Section</h1> <p>Now, to see the shape of subducting slabs below Java let’s plot our earthquake datasets along the Y coordinate cross-section. To make a properly scaled cross-section first we need to transform our coordinate from latitude/longitude in decimal degrees, into UTM in the metric unit so it has the same measurement unit with the depth. Our problem is that we are dealing with a large area that spans multiple UTM zones here, and as far as I know, there is no simple and straightforward solution to this issue. Lucky for us, Google already solved this for us when they were facing the same issue for their Google Maps projects in 2005 by inventing a new projection system called <a href="https://en.wikipedia.org/wiki/Web_Mercator_projection" rel="external nofollow noopener" target="_blank">Web Mercator</a>. Let us make two new columns called ‘X_WM’ and ‘Y_WM’ for our X dan Y coordinate in Web Mercator Projection. We will use <code class="language-plaintext highlighter-rouge">Transformer</code> from <code class="language-plaintext highlighter-rouge">pyproj</code> library to calculate our coordinates transformation.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyproj</span> <span class="kn">import</span> <span class="n">Transformer</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">.</span><span class="nf">from_crs</span><span class="p">(</span><span class="sh">"</span><span class="s">epsg:4326</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">epsg:3857</span><span class="sh">"</span><span class="p">,</span> <span class="n">always_xy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X_WM</span><span class="sh">'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Y_WM</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">longitude</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">latitude</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div> <p>now to make our cross-section in this case we want to use ‘Y_WM’ as our X-axis in the plot, and ‘depth’ as our Y-axis. Remember that depth in our database is still in a positive kilometer so we need to transform it to a negative meter value at our plot by multiplying it by -1000.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Y_WM</span><span class="sh">'</span><span class="p">],</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">),</span>
            <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">]),</span> 
            <span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">coolwarm</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Y_WM</span><span class="sh">'</span><span class="p">]),</span> <span class="nf">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Y_WM</span><span class="sh">'</span><span class="p">])),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_24_0.png" alt="png"></p> <p>Well, yeah, It’s a subduction zone alright. I wonder what our plot would look like if we use ‘X_WM’ coordinate as our X-axis. Let’s try to make one.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X_WM</span><span class="sh">'</span><span class="p">],</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">),</span>
            <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">]),</span> 
            <span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">coolwarm</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X_WM</span><span class="sh">'</span><span class="p">]),</span> <span class="nf">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X_WM</span><span class="sh">'</span><span class="p">])),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">]</span><span class="o">*-</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_26_0.png" alt="png"></p> <p>Obviously, we cannot see the shape of our subduction slab in this cross-section, but we can still get a piece of good information with this visualization. Note another <em>seismic gap</em> around depth 3 km to 5 km. <em>Seismic gaps</em> do not only occur on a horizontal plane but also on a vertical plane. We cannot see this gap clearly on our previous cross-section because our visualization is distracted by an anomaly at the eastern part of our area where apparently there is not much seismic gap there. If you look back at our map plot, you can see that this anomalous area is in the southern part of Sulawesi. Well as any Geologist knows, there are a lot of suspicious things going on in Sulawesi’s tectonic settings, so this kind of anomaly comes as no surprise.</p> <h1 id="depth-and-magnitude-distribution">Depth and magnitude distribution</h1> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="sh">'</span><span class="s">ggplot</span><span class="sh">'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Depth Distribution</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">freq</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">km</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sh">'</span><span class="s">min = %.2f</span><span class="se">\n</span><span class="s">max = %.2f</span><span class="se">\n</span><span class="s">mean = %.2f</span><span class="se">\n</span><span class="s">median = %.2f</span><span class="sh">'</span>
           <span class="o">%</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">median</span><span class="p">()),</span>
           <span class="n">ha</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">,</span>
           <span class="n">va</span><span class="o">=</span><span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">,</span>
           <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Magnitude Distribution</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Mw</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span> 
          <span class="sh">'</span><span class="s">min = %.2f</span><span class="se">\n</span><span class="s">max = %.2f</span><span class="se">\n</span><span class="s">mean = %.2f</span><span class="se">\n</span><span class="s">median = %.2f</span><span class="sh">'</span>
           <span class="o">%</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">median</span><span class="p">()),</span>
           <span class="n">ha</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">,</span>
           <span class="n">va</span><span class="o">=</span><span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">,</span>
           <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_29_0.png" alt="png"></p> <p>The interesting thing to notice in this depth distribution is the anomaly at the deep-focal earthquake, earthquake frequency seems to get lower with depth and reach its lowest point at around 300 km, this is expected due to the increasing plasticity of slabs with depths due to increasing pressure and temperature. What is quite unexpected is the rise of the frequency at around 500 km (it is important to note that deep-focus earthquakes are only observed around a subduction zone, so it is safe to assume that it is directly related to subduction activity). One possible explanation of the deep-focus earthquake is transformational faulting in metastable peridotite wedges within a cold slab. Where the mechanical faulting at those depths is hard to explain, some models suggest that transformational faulting due to polymorphic reactions in which olivine transforms to the spinel structure and clinoenstatite transforms to ilmenite may cause such shear instability (<a href="https://www.earth.northwestern.edu/public/emile/PDF/EAO104.pdf" rel="external nofollow noopener" target="_blank">Kirby et al., 1996</a>). This effect of decreasing seismic activity with depth until it reaches the depth where olivine and clinoesntatie transformation occurs where there is a little bump in the earthquake frequency caused an apparent seismic gap in the vertical plane which occurs at around 300 to 500 km.</p> <p>What is surprising for me is the distribution of the magnitude which closely resembles a normal distribution with mean and median values close to each other (or we can say it a log-normal distribution since the magnitudes are in the Ritcher Scale which is a logarithmic scale) rather than resembling a power-law distribution. As for now, I can’t find any explanation for this, whether this is really the case or we actually have a problem with our datasets where USGS has difficulties in detecting the smaller magnitude earthquakes. This <a href="https://en.wikipedia.org/wiki/Gutenberg%E2%80%93Richter_law#Background" rel="external nofollow noopener" target="_blank">wikipedia page</a> suggests the latter would be the case but also mentions some earthquake dynamics models that explain the lower frequency in lower magnitude earthquakes physically.</p> <p>Now it is probably a good idea to split our dataset into several categories and see the distribution of each. Let’s split the depth into three categories based on <a href="https://www.usgs.gov/natural-hazards/earthquake-hazards/science/determining-depth-earthquake?qt-science_center_objects=0#qt-science_center_objects" rel="external nofollow noopener" target="_blank">USGS classification</a> into:</p> <ul> <li>shallow earthquake (0-70)km</li> <li>intermediate earthquake (70-300)km</li> <li>deep earthquake(&gt;300)km</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth_classification</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">'</span><span class="s">shallow</span><span class="sh">'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span><span class="mi">70</span> <span class="nf">else</span><span class="p">(</span><span class="sh">'</span><span class="s">deep</span><span class="sh">'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span><span class="mi">300</span> <span class="k">else</span> <span class="sh">'</span><span class="s">intermediate</span><span class="sh">'</span><span class="p">))</span>

</code></pre></div></div> <p>In the line above we will use <code class="language-plaintext highlighter-rouge">apply()</code> and <code class="language-plaintext highlighter-rouge">lambda</code> to make a new column called <code class="language-plaintext highlighter-rouge">'depth_classification'</code> in <code class="language-plaintext highlighter-rouge">df</code> Dataframe and put values on it based on the condition in column <code class="language-plaintext highlighter-rouge">depth</code>.</p> <p>Since we need to draw a lot of histograms for depth and magnitude distribution in every classification, let’s write a function to draw it more efficiently</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">classification_histogram</span><span class="p">(</span><span class="n">class_list</span><span class="p">,</span> <span class="n">classification_type</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">nclass</span> <span class="ow">in</span> <span class="n">class_list</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">nclass</span><span class="p">[</span><span class="n">classification_type</span><span class="o">+</span><span class="sh">'</span><span class="s">_classification</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">())[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">hist</span><span class="p">(</span><span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span><span class="sh">'</span><span class="s"> earthquake depth distribution</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sh">'</span><span class="s">min = %.2f</span><span class="se">\n</span><span class="s">max = %.2f</span><span class="se">\n</span><span class="s">mean = %.2f</span><span class="se">\n</span><span class="s">median = %.2f</span><span class="se">\n</span><span class="s">count =%i</span><span class="sh">'</span>
                   <span class="o">%</span><span class="p">(</span><span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> 
                     <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">median</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()),</span>
                   <span class="n">ha</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                   <span class="n">va</span><span class="o">=</span><span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">,</span>
                   <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">hist</span><span class="p">(</span><span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span><span class="sh">'</span><span class="s"> earthquake magnitude distribution</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="nf">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sh">'</span><span class="s">min = %.2f</span><span class="se">\n</span><span class="s">max = %.2f</span><span class="se">\n</span><span class="s">mean = %.2f</span><span class="se">\n</span><span class="s">median = %.2f</span><span class="se">\n</span><span class="s">count =%i</span><span class="sh">'</span>
                   <span class="o">%</span><span class="p">(</span><span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> 
                     <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">median</span><span class="p">(),</span> <span class="n">nclass</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()),</span>
                   <span class="n">ha</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">,</span>
                   <span class="n">va</span><span class="o">=</span><span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                   <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="p">].</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">row</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
</code></pre></div></div> <p>the function above is pretty simple and straightforward, the inline string syntax is not the most pleasant syntax to read, but it is pretty efficient.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">depth_class_list</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">shallow</span><span class="sh">'</span><span class="p">],</span>
                  <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">intermediate</span><span class="sh">'</span><span class="p">],</span>
                  <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">depth_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">deep</span><span class="sh">'</span><span class="p">]]</span>
<span class="nf">classification_histogram</span><span class="p">(</span><span class="n">depth_class_list</span><span class="p">,</span><span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_36_0.png" alt="png"></p> <p>At this stage, I think the normality assumption is reasonable and it could be the basis to split our depth dataset into several groups in our classification. If we look at depth distribution in our present classification, there are still indications of mixing population since we still don’t have an unimodal distribution. I think it is a good idea to try multiple Gaussian fixes in the data in the future, for now, we will settle with this USGS classification.</p> <p>I still don’t think it is a good idea to assume normality in magnitude distribution since I assume that smaller magnitude earthquake occurrences are exponentially higher than larger magnitude occurrences. But since our initial dataset distribution for magnitude shows a normal behavior, I imagine our classification should preserve the shape of the original data (which is the case for this classification), since I assume that earthquake magnitude spreads with the same behavior in all depths. Well, let’s try to split our magnitude to see if that assumption holds!</p> <p>We will divide our magnitude data into several groups based on <a href="http://www.geo.mtu.edu/UPSeis/magnitude.html" rel="external nofollow noopener" target="_blank">this classification</a> into:</p> <ul> <li>minor earthquake (&lt;4)Mw</li> <li>light earthquake (4-5)Mw</li> <li>moderate earthquake (5-6)Mw</li> <li>strong earthquake (6-7)Mw</li> <li>great earthquake (&gt;7)Mw</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">'</span><span class="s">minor</span><span class="sh">'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="nf">else</span><span class="p">(</span>
                                                        <span class="sh">'</span><span class="s">light</span><span class="sh">'</span> <span class="nf">if </span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">)</span> <span class="nf">else </span><span class="p">(</span>
                                                        <span class="sh">'</span><span class="s">moderate</span><span class="sh">'</span> <span class="nf">if </span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">)</span> <span class="nf">else</span><span class="p">(</span>
                                                        <span class="sh">'</span><span class="s">strong</span><span class="sh">'</span> <span class="nf">if </span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="mi">7</span><span class="p">)</span> <span class="k">else</span> <span class="sh">'</span><span class="s">great</span><span class="sh">'</span><span class="p">))))</span>
<span class="n">magnitude_class_list</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">minor</span><span class="sh">'</span><span class="p">],</span>
                     <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">light</span><span class="sh">'</span><span class="p">],</span>
                     <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">moderate</span><span class="sh">'</span><span class="p">],</span>
                     <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">strong</span><span class="sh">'</span><span class="p">],</span>
                     <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">magnitude_classification</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">great</span><span class="sh">'</span><span class="p">]]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">classification_histogram</span><span class="p">(</span><span class="n">magnitude_class_list</span><span class="p">,</span><span class="sh">'</span><span class="s">magnitude</span><span class="sh">'</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/img/Earthquake_Playthrough_01_files/Earthquake_Playthrough_01_40_0.png" alt="png"></p> <p>We can see from the depth histograms that every magnitude group has the same depth distribution pattern which means that our assumption still holds. From the magnitude histograms on the second row, at minor earthquake magnitude distribution, we can see that data are absent at a magnitude around 1 and 2. That is very suspicious and most probably due to incomplete data records. That is probably the reason why we have an unexpected normal distribution of our magnitude data. we can see from another group from light to great earthquake magnitude distribution that the distribution more resembles a power-law distribution. The apparent normal-like distribution that we see from our initial data is most probably due to missing a big chunk of data on the left side of our distribution.</p> <p>I think that is probably all for our today’s playthrough with USGS earthquake data catalog. I believe it is a nice way to exercise Python libraries while acquiring a nice insight into the nature of earthquakes. There is so much that we can still do to our data, a few ideas that I will try for the next few weeks are trying to split our dataset into more detailed categories with multiple Gaussian fit, and calculating energy release in spatial and temporal perspective. And I am pretty sure that there is still so much to explore along the way. I’ll make sure to post my notebook update next week!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/EDA/">Exploratory Data Analysis (EDA) for Hyperspectral Imagery</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/distance/">Different Distance Metrics Example in Spectral Unmixing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/SS-data-summary/">Quick Soil Sampling Data Summary With Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/bayes-unmixing/">Bayesian Spectral Unmixing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Raster-Calculator/">Using Raster Calculator in QGIS GUI and Python Console to Make SR Blocks</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Muhamad Nasir Lukman. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?906085072389244b4db0c89c5b1dd28d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-NY818B7N0G"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NY818B7N0G");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>